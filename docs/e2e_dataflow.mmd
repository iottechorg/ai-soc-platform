sequenceDiagram
    participant DG as ðŸŽ¯ Data Generator
    participant K as ðŸ“¨ Kafka
    participant ML as ðŸ¤– ML Pipeline
    participant CH as ðŸ’¾ ClickHouse
    participant RL as ðŸ§  RL Orchestrator
    participant SE as ðŸŽ¯ Scoring Engine
    participant AS as ðŸ“¢ Alerting Service
    participant SL as ðŸ’¬ Slack
    participant DB as ðŸ“Š Dashboard
    Note over DG,DB: Enhanced SOC Platform - Real-time Threat Detection & Response
    DG->>K: Generate realistic security logs<br/>ðŸ“Š 95% normal, 5% threats
    K->>ML: Consume raw logs<br/>ðŸ“¦ Batch processing
    ML->>CH: Store raw logs<br/>ðŸ’¾ Structured data
    ML->>ML: Enhanced ML Models Process<br/>ðŸŒ² Isolation Forest<br/>ðŸŽ¯ Clustering<br/>ðŸ“ˆ Forbidden Ratio
    ML->>K: Publish anomaly scores<br/>ðŸ“Š topic: anomaly-scores
    
    RL->>ML: Monitor performance<br/>ðŸ“Š Precision, recall, F1
    RL->>ML: Optimize model selection<br/>âš™ï¸ Enable/disable models
    
    K->>SE: Consume anomaly scores<br/>ðŸ“Š Multi-model predictions
    SE->>SE: Aggregate scores<br/>âš–ï¸ 4 aggregation methods
    SE->>SE: Smart Alert Generation<br/>ðŸ§  7 enhanced rules
    
    alt Alert Generated
        SE->>K: Publish alert<br/>ðŸš¨ topic: alerts
        K->>AS: Consume alert<br/>ðŸ“¨ Enhanced processing
        AS->>SL: Rich Slack alert<br/>ðŸ’¬ Attachments, colors
    end
    
    CH->>DB: Query live data<br/>ðŸ“Š Real-time analytics
    DB->>DB: Update dashboard<br/>ðŸ”„ 30-second refresh