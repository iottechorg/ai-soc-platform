---
config:
  look: neo
  layout: fixed
  theme: redux
---
flowchart TB
 subgraph subGraph0["Data Generation Layer"]
        DG["Enhanced Data Generator<br>ğŸ¯ Realistic Threats<br>ğŸ“Š 95% Normal, 5% Threats<br>â° Temporal Patterns"]
  end
 subgraph subGraph1["Infrastructure Layer"]
        K["Kafka<br>ğŸ“¨ Message Streaming<br>ğŸ”„ Topics: raw-logs, anomaly-scores, alerts"]
        CH[("ClickHouse<br>ğŸ“Š Analytics Database<br>âš¡ High Performance")]
  end
 subgraph subGraph2["ML Models"]
        IF["Isolation Forest<br>ğŸŒ² Contamination: 0.06"]
        CL["Clustering<br>ğŸ¯ 8 Clusters"]
        FR["Forbidden Ratio<br>ğŸ“Š Adaptive Windows"]
  end
 subgraph subGraph3["ML Processing Layer"]
        ML["ML Pipeline<br>ğŸ¤– 3 Enhanced Models<br>ğŸ¯ Adaptive Thresholds<br>ğŸ“ˆ Score Normalization"]
        subGraph2
  end
 subgraph subGraph4["Intelligence Layer"]
        RL["RL Orchestrator<br>ğŸ§  PPO Agent<br>âš¡ Auto-Optimization<br>ğŸ”„ Model Selection"]
        SE["Scoring Engine<br>ğŸ¯ Multi-Model Aggregation<br>ğŸ“Š Adaptive Thresholds<br>ğŸš¨ Smart Alerting"]
  end
 subgraph subGraph5["Alert Channels"]
        SL["Slack<br>ğŸ’¬ Rich Formatting"]
        EM["Email<br>ğŸ“§ HTML Templates"]
        WH["Webhook<br>ğŸ”— JSON Payloads"]
  end
 subgraph subGraph6["Response Layer"]
        AS["Alerting Service<br>ğŸ“¨ Multi-Channel<br>ğŸ”„ Deduplication<br>â±ï¸ Rate Limiting"]
        subGraph5
  end
 subgraph subGraph7["Monitoring Layer"]
        DB["Dashboard<br>ğŸ“Š Real-time Monitoring<br>ğŸ“ˆ 4 Interactive Tabs<br>ğŸ” Live Analytics"]
  end
    DG -- Raw Security Logs --> K
    K -- Consume Logs --> ML
    ML --> IF & CL & FR
    ML -- Store Logs --> CH
    ML -- Anomaly Scores --> K
    K -- Consume Scores --> SE
    RL -- Monitor & Control --> ML
    SE -- Alerts --> K
    K -- Consume Alerts --> AS
    AS --> SL & EM & WH
    CH -- Query Data --> DB
    style subGraph3 fill:#C8E6C9
    style subGraph4 fill:#FFE0B2
    style subGraph7 fill:#E1BEE7
    style subGraph6 fill:#FFCDD2
    style subGraph0 fill:#BBDEFB
